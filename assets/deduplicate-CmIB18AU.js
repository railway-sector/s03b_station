import{cj as O,ck as L,cl as R}from"./index-BORJmyT4.js";function E(f,n,s){const e=Array.isArray(f),r=e?f.length/n:f.byteLength/(4*n),h=e?f:new Uint32Array(f,0,r*n),A=s?.minReduction??0,u=s?.originalIndices||null,k=u?u.length:0,i=s?.componentOffsets||null;let b=0;if(i)for(let t=0;t<i.length-1;t++){const c=i[t+1]-i[t];c>b&&(b=c)}else b=r;const w=Math.floor(1.1*b)+1;(a==null||a.length<2*w)&&(a=new Uint32Array(R(2*w)));for(let t=0;t<2*w;t++)a[t]=0;let o=0;const U=!!i&&!!u,m=U?k:r;let y=O(r);const d=new Uint32Array(k),q=1.96;let C=A!==0?Math.ceil(4*q*q/(A*A)*A*(1-A)):m,p=1,I=i?i[1]:m;for(let t=0;t<m;t++){if(t===C){const l=1-o/t;if(l+q*Math.sqrt(l*(1-l)/t)<A)return null;C*=2}if(t===I){for(let l=0;l<2*w;l++)a[l]=0;if(u)for(let l=i[p-1];l<i[p];l++)d[l]=y[u[l]];I=i[++p]}const c=U?u[t]:t,$=c*n,j=B(h,$,n);let g=j%w,x=o;for(;a[2*g+1]!==0;){if(a[2*g]===j){const l=a[2*g+1]-1;if(v(h,$,l*n,n)){x=y[l];break}}g++,g>=w&&(g-=w)}x===o&&(a[2*g]=j,a[2*g+1]=c+1,o++),y[c]=x}if(A!==0&&1-o/r<A)return null;if(U){for(let t=i[p-1];t<d.length;t++)d[t]=y[u[t]];y=L(d)}const M=e?new Array(o):new Uint32Array(o*n);o=0;for(let t=0;t<m;t++)y[t]===o&&(z(h,(U?u[t]:t)*n,M,o*n,n),o++);if(u&&!U){const t=new Uint32Array(k);for(let c=0;c<t.length;c++)t[c]=y[u[c]];y=L(t)}return{buffer:Array.isArray(M)?M:M.buffer,indices:y,uniqueCount:o}}function v(f,n,s,e){for(let r=0;r<e;r++)if(f[n+r]!==f[s+r])return!1;return!0}function z(f,n,s,e,r){for(let h=0;h<r;h++)s[e+h]=f[n+h]}function B(f,n,s){let e=0;for(let r=0;r<s;r++)e=f[n+r]+e|0,e=e+(e<<11)+(e>>>2)|0;return e>>>0}let a=null;export{E as e};
